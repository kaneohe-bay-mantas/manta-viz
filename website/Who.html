<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Manta</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>

    <header id='menu'>
        <br>
        <div class="ui inverted container">
            <div class="ui inverted segment">
                <h1 class='ui centered header'>The Mantas of Kaneohe Bay</h1>
                <div class="ui inverted secondary pointing six item menu">
                    <a class="item" href="index.html" id="font">Home</a>
                    <a class="item" href="What.html" id="font">What</a>
                    <a class="item" href="Where.html" id="font">Where</a>
                    <a class="item" href="When.html" id="font">When</a>
                    <a class="active item" href="Who.html" id="font">Who</a>
                    <a class="item" href="Why.html" id="font">Why</a>
                </div>
            </div>
        </div>
    </header>

    <div style='padding-top: 200px;'>
        <div class="ui grid">
            <div class="ui three wide column"></div>

            <div class="ui ten wide column">
                <div class="ui three column grid container">
                    <div class="ui centered row">
                        <h1 class="ui header" id="font" style="color:black">Who lives in the bay?</h1>
                    </div>

                    <!--template-->
                    <div class="ui grid container" id='clark'>
                        <div class="ui row">
                            <div class="ui card" style="width:100%">
                                <div class="content">
                                    <h1 class="ui header" id="font">line plot, photos</h1>
                                </div>
                                <div class="content">

                                    <h4 class="ui sub header" id="font">Title</h4>
                                    <p id='font'>
                                        Place holder
                                    </p>
                                    <div id="population" style="width:100%">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ui three wide column"></div>
        </div>


        <div class="ui fotter container">
            <hr>
            <h5 class="ui centered header" id="font" style="color:black">University of Hawaii at Manoa ICS484 / ACM484
                Group Project</h5>
            <br>
        </div>
    </div>





</body>

<script>
    Plotly.d3.csv('../data/ids.csv', function (err, rows) {
        function unpack(rows, key) {
            return rows.map(function (row) { return row[key]; });
        }

        var sighting = unpack(rows, 'Overall Sighting').map(x=>+x);
        var manta_id = unpack(rows, 'Manta ID').map(x=>+x);
        var new_manta = unpack(rows, 'New Manta');
        var new_manta_count = 0;
        var new_mantas = [];
        for (i in new_manta) {
            if(new_manta[i] == 'T') {
                new_manta_count += 1;
            }
            new_mantas[i]=new_manta_count;
        };

        var a = 23.94;
        var b = -0.05;

        var pred_new_mantas = [];
        for(i in sighting) {
            pred_new_mantas[i] = a * (1 - Math.exp(b * sighting[i]));
        }

        var sightings = {
            x: sighting,
            y: new_mantas,
            mode: 'markers',
            name: 'Manta Sighting',
            marker: {
                color: '#26669E',
                size: 10
            }
        };

        var asymptote = {
            x: [0, sighting.length],
            y: [a, a],
            mode: 'lines',
            name: 'Population Estimate',
            line: {
                color: '#EB8F57',
                dash: 'dash',
                width: 4
            }
        };

        var fit = {
            x: sighting,
            y: pred_new_mantas,
            mode: 'lines',
            name: 'Data Fit',
            line: {
                color: '8EC1ED',
                width: 4
            }
        }

        var data = [sightings, asymptote, fit];

        var population_layout = {
            xaxis: {
                title: '# of Manta Sightings'
            },
            yaxis: {
                title: '# of Unique Mantas'
            }
        }

        Plotly.newPlot('population', data, population_layout);

    })

</script>

</html>