<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Manta</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    

</head>

<body>


    <header id='menu'>
        <br>
        <div class="ui inverted container">
            <div class="ui inverted segment">
                <h1 class='ui centered header'>The Mantas of Kaneohe Bay</h1>
                <div class="ui inverted secondary pointing six item menu">
                    <a class="item" href="index.html" id="font">Home</a>
                    <a class="item" href="What.html" id="font">What</a>
                    <a class="item" href="Where.html" id="font">Where</a>
                    <a class="active item" href="When.html" id="font">When</a>
                    <a class="item" href="Who.html" id="font">Who</a>
                    <a class="item" href="Why.html" id="font">Why</a>
                </div>
            </div>
        </div>
    </header>

    <div style='padding-top: 200px;'>
        <div class="ui grid">
            <div class="ui three wide column"></div>

            <div class="ui ten wide column">
                <div class="ui three column grid container">
                    <div class="ui centered row">
                        <h1 class="ui header" id="font" style="color:black">When are they around?</h1>
                    </div>

                    <!--template-->
                    <div class="ui grid container" id='clark'>
                        <div class="ui row">
                            <div class="ui card" style="width:100%">
                                
                                <div class="content">

                                    <h4 class="ui sub header" id="font">Title</h4>
                                    <p id='font'>
                                        The distribution of plankton in nearshore waters tends to vary with the tide. Since tides are most extreme during the full and new moon, it is possible that moon phase also affects the distribution of plankton, and accordingly the mantas that feed on them. Thus, there is reason to believe that the number of mantas observed in the bay may vary with both the tide and the moon phase. The plots below show how the number of mantas observed varies with the moon phase (left) and tide (right). Individual days are shown with dots. The angle at which the dot is drawn around the origin indicates the moon phase or tide at the time mantas were sighted, and the distance the dot is drawn from the origin indicates the number of mantas observed.
                                    </p>
                                    <br>
                                    <div id="lunar" style="width: 49%; float: left;"></div>
                                    <div id="tidal" style="width: 49%; float: left;"></div>
                                    <p id='font'>
                                        More mantas are observed on rising tides and in the period leading up to the new moon (and to a lesser extent the full moon). On a rising tide water flows into the bay. Due to differences in salinity the water entering the bay tends to be denser than water already present, so incoming water flows through the bay at depth. However, when this water encounters an obstacle such as a patch reef or the sandbar, it is forced toward the surface in a process called upwelling. This concentrates plankton and other particles near these ledges, explaining both the increased feeding by mantas during rising tides and concentration of manta sightings along the sandbar ledge. In the period around the full and new moon tide are more extreme, further concentrating plankton along the ledges.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
            <div class="ui three wide column"></div>
        </div>

        <div class="ui fotter container">
            <hr>
            <h5 class="ui centered header" id="font" style="color:black">University of Hawaii at Manoa ICS484 /
                ACM484 Group Project</h5>
            <br>
        </div>


    </div>




</body>

<script>
    Plotly.d3.csv('./data/polar_data.csv', function (err, rows) {
        function unpack(rows, key) {
            return rows.map(function (row) { return row[key]; });
        }
        console.log(rows);

        var days = unpack(rows, 'lunar_deg');
        for (i in days) {
            days[i] = Math.round(days[i] * 28 / 360)
        }
        console.log(days)

        var lunar_data = [
            {
                type: "scatterpolar",
                name: "angular categories",
                r: unpack(rows, 'Group_Size'),
                theta: days,
                mode: "markers",
                name: "Group Size",
                marker: {
                    color: "#46CF91",
                    size: 15,
                    line: {
                        color: "white"
                    },
                    opacity: 0.7
                },
                //cliponaxis: false,
                hovertext: "test",
                hovertemplate: "%{r} mantas, \n <extra>%{theta} days since the full moon</extra>"
            }
        ]

        var lunar_layout = {
            title: "by Lunar Day",
            font: {
                size: 15
            },
            showlegend: false,
            polar: {
                bgcolor: "rgb(223, 223, 223)",
                angularaxis: {
                    type: "category",
                    categoryorder: "array",
                    categoryarray: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28],
                    tickwidth: 2,
                    tickfont: {
                        size: 14
                    },
                    ticktext: [0, 7, 14, 21],
                    linewidth: 3,
                    layer: "below traces",
                    title: "Lunar Day",
                    gridcolor: "#8EC1ED"

                },
                radialaxis: {
                    side: "counterclockwise",
                    showline: true,
                    linewidth: 2,
                    tickwidth: 2,
                    tickfont: {
                        color: "#437860",
                        size: 12
                    },
                    gridcolor: "white",
                    gridwidth: 2,
                    title: "Group Size",
                    titlefont: {
                        color: '#437860',
                        size: 12
                    }
                }
            },
            paper_bgcolor: "rgb(223, 223, 223)",
        }
        Plotly.newPlot('lunar', lunar_data, lunar_layout);

        /////// Plot 2: tide data ///////////////////////////////
        var tidal_data = [
            {
                type: "scatterpolar",
                name: "angular categories",
                r: unpack(rows, 'Group_Size'),
                theta: unpack(rows, 'Tidal_phase'),
                mode: "markers",
                name: "Group Size",
                marker: {
                    color: "#8EC1ED",
                    size: 15,
                    line: {
                        color: "white"
                    },
                    opacity: 0.7
                },
                //cliponaxis: false,
                hovertext: "test",
                hovertemplate: "%{r} mantas"
            }
        ]

        var tidal_layout = {
            title: "by Tidal Phase (0 = high, 180 = low)",
            font: {
                size: 14
            },
            showlegend: false,
            polar: {
                bgcolor: "rgb(223, 223, 223)",
                angularaxis: {
                    //type: "category",
                    //categoryorder: "array",
                    //categoryarray: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],
                    tickwidth: 2,
                    tickfont: {
                        size: 14
                    },
                    linewidth: 3,
                    layer: "below traces",
                    title: "tidal Day",
                    gridcolor: "#8EC1ED"

                },
                radialaxis: {
                    side: "counterclockwise",
                    showline: true,
                    linewidth: 2,
                    tickwidth: 2,
                    tickfont: {
                        color: "#437860",
                        size: 12
                    },
                    gridcolor: "white",
                    gridwidth: 2,
                    title: "Group Size",
                    titlefont: {
                        color: '#437860',
                        size: 12
                    }
                }
            },
            paper_bgcolor: "rgb(223, 223, 223)",
        }

        Plotly.newPlot('tidal', tidal_data, tidal_layout);

    })

</script>

</html>